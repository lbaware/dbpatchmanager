trigger:
- master
pool:
  vmImage: 'ubuntu-latest'
variables:
  system.debug: true
  buildConfiguration: 'Release'
  Version: '2.0.0.$(Build.BuildID)'
steps:
- bash: echo v$(Version)
- task: DotNetCoreCLI@2
  inputs:
    command: 'build'
    projects: 'src/Ormico.DbPatchManager.sln'
    workingDirectory: 'src'
    arguments: '--configuration $(buildConfiguration) --output $(Build.ArtifactStagingDirectory)'
- task: DotNetCoreCLI@2
  inputs:
    command: 'publish'
    projects: 'src/Ormico.DbPatchManager.CLI/Ormico.DbPatchManager.CLI.csproj'
    workingDirectory: 'src'
    arguments: '--configuration $(buildConfiguration)'
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: '$(Build.ArtifactStagingDirectory)'
    artifactName: nuget-artifacts
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: 'src/Ormico.DbPatchManager.CLI/bin/Release/netcoreapp2.2/publish/'
    artifactName: zip-artifacts
